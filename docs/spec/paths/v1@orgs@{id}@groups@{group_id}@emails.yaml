post:
  tags:
    - Email Invitations
  summary: Create an email invitation to the group
  security:
    - Bearer: []
  description: |
    Requires JWT token with the organization owner or group admin or superadmin permissions.

    Creates a `request` entry with corresponding list of schemas in attributes generated by the service.
    
    Returns created email invitation.
  operationId: createInvitationEmail
  parameters:
    - in: path
      name: 'id'
      required: true
      description: The ID of the organization
      schema:
        type: string
        example: "3a798290-caf1-496a-a7e5-4db32551b13d"
    - in: path
      name: 'group_id'
      required: true
      description: The ID of the group
      schema:
        type: string
        example: "6c8c1a69-177e-4754-a4e1-d4a7dbf561e8"
  requestBody:
    required: true
    content:
      application/vnd.api+json:
        schema:
          type: object
          required:
            - data
          properties:
            data:
              $ref: '#/components/schemas/InvitationCreateEmail'
  responses:
    200:
      description: OK
      content:
        application/vnd.api+json:
          schema:
            type: object
            required:
              - data
              - included
            properties:
              data:
                $ref: '#/components/schemas/InvitationEmail'
              included:
                type: array
                items:
                  oneOf:
                    - $ref: '#/components/schemas/Request'
    400:
      $ref: '#/components/responses/invalidParameter'
    401:
      $ref: '#/components/responses/invalidAuth'
    404:
      $ref: '#/components/responses/notFound'
    500:
      $ref: '#/components/responses/internalError'

patch:
  tags:
    - Email Invitations
  summary: Accept an email invitation to the group
  description: |
    Submit OTP code to register the user email and connect it with user DID. 
    If OTP is correct - claim for user email will be issued and user will be saved to the service. 
    After that use becomes able to authenticate for executing requests with JWT. 
    Also, corresponding request entry will be filled with user DID. Also claim for `undefined` role will be issued.
    
    Returns accepted email invitation.
  operationId: acceptInvitationEmail
  parameters:
    - in: path
      name: 'id'
      required: true
      description: The ID of the organization
      schema:
        type: string
        example: "3a798290-caf1-496a-a7e5-4db32551b13d"
    - in: path
      name: 'group_id'
      required: true
      description: The ID of the group
      schema:
        type: string
        example: "6c8c1a69-177e-4754-a4e1-d4a7dbf561e8"
  requestBody:
    required: true
    content:
      application/vnd.api+json:
        schema:
          type: object
          required:
            - data
          properties:
            data:
              $ref: '#/components/schemas/InvitationAcceptEmail'
  responses:
    200:
      description: OK
      content:
        application/vnd.api+json:
          schema:
            type: object
            required:
              - data
              - included
            properties:
              data:
                $ref: '#/components/schemas/InvitationEmail'
              included:
                type: array
                items:
                  oneOf:
                    - $ref: '#/components/schemas/Request'
    400:
      $ref: '#/components/responses/invalidParameter'
    404:
      $ref: '#/components/responses/notFound'
    500:
      $ref: '#/components/responses/internalError'
